# Current 방식 vs Airflow 방식 분석

## TL;DR

- 지금 구조는 **UI에서 즉시 실험 실행/확인**하는 데 매우 빠르고 단순합니다.
- Airflow는 **정기 스케줄, 의존성 있는 다단계 파이프라인, 재시도/백필/운영 가시성**이 필요할 때 강합니다.
- 결론적으로 현재 단계에서는 **전면 전환보다 하이브리드(현행 유지 + 필요한 흐름만 Airflow)**가 가장 현실적입니다.

## 현재 방식(현행) 정리

현재 실행 흐름은 다음 성격을 가집니다.

- 트리거: 웹 UI/API에서 수동 실행 (`/api/runs/start`)
- 실행 엔진: 백엔드에서 Python subprocess 직접 실행
- 상태 저장: 프로세스 상태/로그를 앱 메모리에서 관리
- 관측: MLflow/TensorBoard + UI polling
- 설정 단일화: `backend/config/training_catalog.yaml` 중심

근거 코드/문서:

- 실행/상태 관리: `backend/app/services/run_manager.py`
- API 엔드포인트: `backend/app/api/routes.py`
- 설정 단일화 설명: `docs/architecture/ARCHITECTURE.md`

## Airflow 방식 정리

Airflow 기준으로 바꾸면 일반적으로 다음이 핵심입니다.

- DAG 기반 의존성 관리(전처리 → 학습 → 평가 → 등록/배포)
- 스케줄/캘린더 기반 자동 실행
- 실패 재시도, 백필(backfill), 실행 이력 영속화
- 운영용 모니터링/알림 연계(태스크 단위)
- 실행자(Local/Celery/Kubernetes)에 따른 수평 확장

## 비교표

| 항목 | 현재 방식 | Airflow 방식 |
| --- | --- | --- |
| 실행 시작 | UI/API 수동 트리거 중심 | 수동 + 스케줄 + 이벤트 확장 |
| 파이프라인 의존성 | 코드 내부 순차 처리 중심 | DAG로 명시적 의존성 관리 |
| 실패 처리 | 프로세스 실패 감지/중지 중심 | 태스크별 재시도/재실행/백필 |
| 상태 영속성 | 런 상태는 앱 프로세스 메모리 중심 | 메타DB에 실행 이력 영속화 |
| 운영 가시성 | 앱 UI + MLflow 중심 | DAG/Task 운영 UI + 로그 체계 |
| 확장성 | 단일 백엔드 프로세스 중심 | Executor 기반 확장 가능 |
| 온보딩 난이도 | 낮음 | 중간~높음 (Airflow 운영 지식 필요) |
| 운영 비용 | 낮음 | 중간~높음 (컴포넌트/장애 대응 증가) |

## “Airflow로 발전”이 필요한 조건

아래 조건이 2~3개 이상이면 도입 필요성이 높습니다.

1. 정기 재학습(예: 매일/매주) 자동화가 필요하다.
2. 전처리/검증/학습/평가/배포 승인 같은 다단계 의존성이 명확하다.
3. 실패 재시도, 지연 실행, 백필이 운영 요구사항이다.
4. 팀이 늘어나고 운영 책임 분리가 필요하다.
5. 단일 프로세스 기반 실행으로 병목/가시성 한계가 보인다.

반대로 아래에 가깝다면 현행 유지가 더 효율적입니다.

- 실험은 주로 수동 실행이고, 즉시 확인/반복이 중요함
- 파이프라인이 단순하며 운영 자동화 요구가 크지 않음
- 인프라 운영 부담을 늘리고 싶지 않음

## 추천 전략: 전면 전환 대신 하이브리드

### 1단계 (즉시 가능, 저위험)

- 현행 UI/API/`training_catalog.yaml` 구조 유지
- “배치성 높은 흐름”만 후보 선정:
  - 정기 retrain
  - nightly best-model publish
  - 주기적 품질 리포트 생성

### 2단계 (PoC)

- Airflow DAG 1~2개만 파일럿 적용
- DAG 내부에서 기존 실행 경로를 재사용:
  - 기존 Python entrypoint 또는 API 호출
  - MLflow/FTP 레지스트리 로직은 최대한 재사용

### 3단계 (확장 판단)

- PoC에서 다음 지표로 확대 여부 결정:
  - 수동 개입 시간 감소
  - 실패 복구 시간(MTTR) 개선
  - 야간/주기 작업 안정성

## 이 레포 기준 권장안

현재 구조는 실험 속도와 유연성이 강점이므로, 지금 즉시 “전체 Airflow 전환”은 비용 대비 이득이 작을 가능성이 큽니다.
다만 운영 배치가 늘어날 가능성이 높기 때문에, **Airflow를 보조 오케스트레이터로 병행 도입**하는 방향이 적합합니다.

즉, 결론은:

- 지금 당장 필수: **아님**
- 중기 확장 대비: **필요 가능성 높음**
- 실행 방식: **하이브리드로 단계 도입 권장**

